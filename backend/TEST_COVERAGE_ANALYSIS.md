# ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸åˆ†æãƒ¬ãƒãƒ¼ãƒˆ

## æ¦‚è¦
- **ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 95ãƒ•ã‚¡ã‚¤ãƒ«
- **çµ±åˆãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ•°**: 31ãƒ•ã‚¡ã‚¤ãƒ«
- **åˆ†ææ—¥**: 2026-02-02

## ç¾åœ¨ã®ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸çŠ¶æ³

### 1. ã‚«ãƒãƒ¼ã•ã‚Œã¦ã„ã‚‹ã‚¨ãƒªã‚¢ï¼ˆçµ±åˆãƒ†ã‚¹ãƒˆã‚ã‚Šï¼‰

| ã‚¨ãƒªã‚¢ | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|--------|---------------|-----------|
| èªè¨¼API | `auth_api.rs` | âœ… è‰¯å¥½ |
| ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç† | `admin_users_api.rs` | âœ… ä¿®æ­£æ¸ˆ |
| ç®¡ç†è€…ç¥æ—¥ç®¡ç† | `admin_holidays_api.rs` | âœ… ä¿®æ­£æ¸ˆ |
| ç¥æ—¥ä¸€è¦§ | `admin_holiday_list.rs` | âœ… è‰¯å¥½ |
| ç¥æ—¥ãƒªãƒã‚¸ãƒˆãƒª | `holiday_repository.rs` | âœ… è‰¯å¥½ |
| å‹¤æ€ ãƒªãƒã‚¸ãƒˆãƒª | `attendance_repository.rs` | âœ… è‰¯å¥½ |
| ç›£æŸ»ãƒ­ã‚°ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ | `audit_log_middleware.rs` | âœ… è‰¯å¥½ |
| ç›£æŸ»ãƒ­ã‚°ãƒªãƒã‚¸ãƒˆãƒª | `audit_log_repo.rs` | âœ… è‰¯å¥½ |
| ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ | `password_reset_api.rs` | âœ… è‰¯å¥½ |
| ç”³è«‹ãƒªãƒã‚¸ãƒˆãƒª | `request_repositories.rs` | âœ… è‰¯å¥½ |
| åˆ©ç”¨è€…ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | `subject_requests_api.rs` | âœ… è‰¯å¥½ |
| åŒæ„ãƒ­ã‚° | `consent_log_repo.rs` | âœ… è‰¯å¥½ |
| ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç† | `active_session_repo.rs` | âœ… è‰¯å¥½ |
| é€±ä¼‘æ—¥è¦ç´„ | `weekly_holiday_convention.rs` | âœ… è‰¯å¥½ |
| ãƒ¬ãƒ¼ãƒˆåˆ¶é™ | `rate_limit_integration_tests.rs` | âœ… è‰¯å¥½ |
| è¨­å®šAPI | `config_api.rs` | âœ… è‰¯å¥½ |
| ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–° | `user_update_api.rs` | âœ… è‰¯å¥½ |
| ç®¡ç†è€…ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ | `admin_export_api.rs` | âœ… è‰¯å¥½ |
| å‹¤æ€ ä¼‘æ†©API | `attendance_breaks_api.rs` | âœ… è‰¯å¥½ |
| ç¥æ—¥ä¾‹å¤–ãƒ•ãƒ­ãƒ¼ | `holiday_exception_flow.rs` | âœ… è‰¯å¥½ |

### 2. Mockãƒ†ã‚¹ãƒˆï¼ˆå˜ä½“ãƒ†ã‚¹ãƒˆãƒ¬ãƒ™ãƒ«ï¼‰

| ã‚¨ãƒªã‚¢ | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
|--------|---------------|-----------|
| ä¼‘æš‡ç”³è«‹ãƒªãƒã‚¸ãƒˆãƒªMock | `leave_request_repository_mock.rs` | âœ… ã‚ã‚Š |
| æ®‹æ¥­ç”³è«‹ãƒªãƒã‚¸ãƒˆãƒªMock | `overtime_request_repository_mock.rs` | âœ… ã‚ã‚Š |
| ç¥æ—¥ãƒªãƒã‚¸ãƒˆãƒªMock | `holiday_repository_mock.rs` | âœ… ã‚ã‚Š |
| å‹¤æ€ ãƒªãƒã‚¸ãƒˆãƒªMock | `attendance_repository_mock.rs` | âœ… ã‚ã‚Š |

### 3. æœªã‚«ãƒãƒ¼/ä¸è¶³ã‚¨ãƒªã‚¢ï¼ˆå„ªå…ˆåº¦é †ï¼‰

#### ğŸ”´ **é«˜å„ªå…ˆåº¦ï¼ˆæ©Ÿèƒ½æœªãƒ†ã‚¹ãƒˆï¼‰**

| ã‚¨ãƒªã‚¢ | ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ« | ç†ç”± | æ¨å®šå·¥æ•° |
|--------|---------------|------|---------|
| **1. å‹¤æ€ æ‰“åˆ»ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ** | `handlers/attendance.rs` | æ ¸å¿ƒæ©Ÿèƒ½ã ãŒAPIãƒ¬ãƒ™ãƒ«ã®çµ±åˆãƒ†ã‚¹ãƒˆãªã— | 4-6h |
| **2. ä¼‘æš‡ãƒ»æ®‹æ¥­ç”³è«‹API** | `handlers/requests.rs` | ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯é‡è¦ã ãŒçµ±åˆãƒ†ã‚¹ãƒˆãªã— | 4-6h |
| **3. ç®¡ç†è€…å‹¤æ€ ç®¡ç†** | `handlers/admin/attendance.rs` | ç®¡ç†è€…æ©Ÿèƒ½ã®é‡è¦éƒ¨åˆ† | 3-4h |
| **4. ç®¡ç†è€…ç”³è«‹æ‰¿èª** | `handlers/admin/requests.rs` | æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœªãƒ†ã‚¹ãƒˆ | 3-4h |
| **5. MFAæ©Ÿèƒ½** | `handlers/auth.rs` (MFAéƒ¨åˆ†) | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£é‡è¦ | 2-3h |

#### ğŸŸ¡ **ä¸­å„ªå…ˆåº¦ï¼ˆéƒ¨åˆ†çš„ã‚«ãƒãƒ¼ï¼‰**

| ã‚¨ãƒªã‚¢ | ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ« | ç¾çŠ¶ | æ¨å®šå·¥æ•° |
|--------|---------------|------|---------|
| **6. ç›£æŸ»ãƒ­ã‚°èª­è¾¼ãƒ»ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ** | `audit_log_read_export.rs` | ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã‚ã‚‹ãŒè©³ç´°ä¸æ˜ | 2-3h |
| **7. ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†API** | `handlers/sessions.rs` | ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒªã‚¹ãƒˆãƒ»å¤±åŠ¹æ©Ÿèƒ½ | 2-3h |
| **8. åŒæ„ç®¡ç†** | `handlers/consents.rs` | GDPRå¯¾å¿œé‡è¦ | 2-3h |
| **9. åˆ©ç”¨è€…ãƒªã‚¯ã‚¨ã‚¹ãƒˆç®¡ç†** | `handlers/admin/subject_requests.rs` | ç®¡ç†è€…å´ã®å‡¦ç† | 2-3h |
| **10. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ãƒ»å±¥æ­´** | `handlers/auth.rs` (passwordéƒ¨åˆ†) | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ | 2-3h |

#### ğŸŸ¢ **ä½å„ªå…ˆåº¦ï¼ˆã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ãƒ»utilsï¼‰**

| ã‚¨ãƒªã‚¢ | ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ« | ç†ç”± | æ¨å®šå·¥æ•° |
|--------|---------------|------|---------|
| 11. CSVãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ | `utils/csv.rs` | ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•° | 1-2h |
| 12. JWTãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ | `utils/jwt.rs` | éƒ¨åˆ†çš„ã«ã‚«ãƒãƒ¼æ¸ˆ | 1-2h |
| 13. ãƒ¡ãƒ¼ãƒ«ã‚µãƒ¼ãƒ“ã‚¹ | `utils/email.rs` | ãƒ¢ãƒƒã‚¯åŒ–å¿…è¦ | 1-2h |
| 14. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ« | `validation/rules.rs` | å˜ä½“ãƒ†ã‚¹ãƒˆã§ååˆ†ã‹ã‚‚ | 1h |
| 15. ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ | `middleware/rate_limit.rs` | æ—¢å­˜ãƒ†ã‚¹ãƒˆã‚ã‚Š | 1h |
| 16. ãƒ­ã‚®ãƒ³ã‚°ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ | `middleware/logging.rs` | ã‚¤ãƒ³ãƒ•ãƒ©å±¤ | 1h |
| 17. ãƒªã‚¯ã‚¨ã‚¹ãƒˆID | `middleware/request_id.rs` | ã‚¤ãƒ³ãƒ•ãƒ©å±¤ | 1h |

### 4. ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«åˆ¥è©³ç´°ãƒãƒƒãƒ”ãƒ³ã‚°

#### Handlerså±¤ (11ãƒ•ã‚¡ã‚¤ãƒ«)
```
src/handlers/
â”œâ”€â”€ auth.rs (642è¡Œ)              - auth_api.rsã§éƒ¨åˆ†çš„ã‚«ãƒãƒ¼ã€MFAãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´ã¯æœªã‚«ãƒãƒ¼
â”œâ”€â”€ attendance.rs (610è¡Œ)        - ğŸ”´ çµ±åˆãƒ†ã‚¹ãƒˆãªã—ï¼ˆæœ€å„ªå…ˆï¼‰
â”œâ”€â”€ requests.rs                  - ğŸ”´ çµ±åˆãƒ†ã‚¹ãƒˆãªã—ï¼ˆæ¬¡ç‚¹å„ªå…ˆï¼‰
â”œâ”€â”€ config.rs                    - âœ… config_api.rsã§ã‚«ãƒãƒ¼
â”œâ”€â”€ sessions.rs                  - ğŸŸ¡ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
â”œâ”€â”€ consents.rs                  - ğŸŸ¡ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
â”œâ”€â”€ subject_requests.rs          - ğŸŸ¡ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
â”œâ”€â”€ holiday_exceptions.rs        - ğŸŸ¡ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
â”œâ”€â”€ admin/
â”‚   â”œâ”€â”€ users.rs                 - âœ… admin_users_api.rsã§ã‚«ãƒãƒ¼
â”‚   â”œâ”€â”€ holidays.rs              - âœ… admin_holidays_api.rsã§ã‚«ãƒãƒ¼
â”‚   â”œâ”€â”€ attendance.rs            - ğŸ”´ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
â”‚   â”œâ”€â”€ requests.rs              - ğŸ”´ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
â”‚   â”œâ”€â”€ export.rs                - âœ… admin_export_api.rsã§ã‚«ãƒãƒ¼
â”‚   â”œâ”€â”€ sessions.rs              - ğŸŸ¡ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
â”‚   â”œâ”€â”€ audit_logs.rs            - ğŸŸ¡ éƒ¨åˆ†çš„ã‚«ãƒãƒ¼
â”‚   â””â”€â”€ subject_requests.rs      - ğŸŸ¡ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
```

#### Serviceså±¤ (6ãƒ•ã‚¡ã‚¤ãƒ«)
```
src/services/
â”œâ”€â”€ holiday.rs                   - âœ… holiday_service.rsã§ã‚«ãƒãƒ¼
â”œâ”€â”€ holiday_exception.rs         - ğŸŸ¢ ç°¡æ˜“çš„ãªãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ audit_log.rs                 - âœ… éƒ¨åˆ†çš„ã‚«ãƒãƒ¼
â”œâ”€â”€ consent_log.rs               - ğŸŸ¢ ç°¡æ˜“çš„ãªãƒ­ã‚¸ãƒƒã‚¯
â”œâ”€â”€ token_cache.rs               - ğŸŸ¢ Redisä¾å­˜ï¼ˆMockå¿…è¦ï¼‰
â””â”€â”€ mod.rs
```

#### Repositorieså±¤ (19ãƒ•ã‚¡ã‚¤ãƒ«)
```
src/repositories/
â”œâ”€â”€ user.rs, user_repository.rs  - âœ… ãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ attendance.rs, attendance_repository.rs     - âœ… ãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ leave_request.rs, leave_request_repository.rs - âœ… Mockãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ overtime_request.rs, overtime_request_repository.rs - âœ… Mockãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ holiday.rs, holiday_repository.rs           - âœ… ãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ auth.rs                      - âœ… auth_api.rsçµŒç”±ã§ã‚«ãƒãƒ¼
â”œâ”€â”€ password_reset.rs            - âœ… password_reset_api.rsã§ã‚«ãƒãƒ¼
â”œâ”€â”€ audit_log.rs                 - âœ… ãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ consent_log.rs               - âœ… ãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ subject_request.rs           - âœ… ãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ active_session.rs            - âœ… ãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ weekly_holiday.rs            - âœ… ãƒ†ã‚¹ãƒˆã‚ã‚Š
â”œâ”€â”€ holiday_exception.rs         - ğŸŸ¡ çµ±åˆãƒ†ã‚¹ãƒˆãªã—
â”œâ”€â”€ break_record.rs              - âœ… attendance_repository.rsã§é–“æ¥ã‚«ãƒãƒ¼
â”œâ”€â”€ transaction.rs               - ğŸŸ¢ å˜ç´”ãªãƒ©ãƒƒãƒ‘ãƒ¼
â””â”€â”€ common.rs, permissions.rs    - ğŸŸ¢ ãƒ˜ãƒ«ãƒ‘ãƒ¼
```

## æ¨å¥¨å®Ÿè£…é †åº

### Phase 1: æ ¸å¿ƒæ©Ÿèƒ½ï¼ˆWeek 1ï¼‰
1. **`tests/attendance_api.rs`** - å‹¤æ€ æ‰“åˆ»ã®çµ±åˆãƒ†ã‚¹ãƒˆ
   - å‡ºå‹¤ã€ä¼‘æ†©é–‹å§‹/çµ‚äº†ã€é€€å‹¤ã®ãƒ•ãƒ­ãƒ¼
   - æ—¢å­˜ã®å‹¤æ€ å–å¾—
   - ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼

2. **`tests/leave_request_api.rs`** - ä¼‘æš‡ç”³è«‹APIãƒ†ã‚¹ãƒˆ
   - ç”³è«‹ä½œæˆ
   - ä¸€è¦§å–å¾—
   - ã‚­ãƒ£ãƒ³ã‚»ãƒ«

3. **`tests/overtime_request_api.rs`** - æ®‹æ¥­ç”³è«‹APIãƒ†ã‚¹ãƒˆ
   - ç”³è«‹ä½œæˆ
   - ä¸€è¦§å–å¾—
   - ã‚­ãƒ£ãƒ³ã‚»ãƒ«

### Phase 2: ç®¡ç†è€…æ©Ÿèƒ½ï¼ˆWeek 2ï¼‰
4. **`tests/admin_attendance_api.rs`** - ç®¡ç†è€…å‹¤æ€ ç®¡ç†
   - å…¨å¾“æ¥­å“¡å‹¤æ€ ä¸€è¦§
   - ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°

5. **`tests/admin_requests_api.rs`** - ç”³è«‹æ‰¿èªãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼
   - æ‰¿èªå‡¦ç†
   - å´ä¸‹å‡¦ç†
   - æ¨©é™ãƒã‚§ãƒƒã‚¯

### Phase 3: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ»ãã®ä»–ï¼ˆWeek 3ï¼‰
6. **`tests/mfa_api.rs`** - MFAæ©Ÿèƒ½ã®çµ±åˆãƒ†ã‚¹ãƒˆ
7. **`tests/session_api.rs`** - ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†API
8. **`tests/consent_api.rs`** - åŒæ„ç®¡ç†API

## ã‚«ãƒãƒ¬ãƒƒã‚¸å‘ä¸Šã®è¦‹è¾¼ã¿

ç¾åœ¨ã®æ¨å®šã‚«ãƒãƒ¬ãƒƒã‚¸: **45-55%**

ä¸Šè¨˜Phase 1-3å®Ÿæ–½å¾Œã®è¦‹è¾¼ã¿: **70-80%**

æ®‹ã‚Šã®20-30%ã¯ä»¥ä¸‹ã§æ§‹æˆ:
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ‘ã‚¹
- ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹
- ã‚¤ãƒ³ãƒ•ãƒ©å±¤ï¼ˆãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢ã€DBæ¥ç¶šï¼‰
- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
